<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4"
	layout:decorator="fragments/template">
<head lang="it">
</head>
<body>
	<!-- fragment interno della persona, la parte di paginazione è gestita dai file personaShow e personaEdit -->
	<!-- parametri del fragment: boolean passato come parametro e prende personaWrapper dal module del chiamante -->
	<th:block th:fragment="persona(editabile)">
		<!-- ogni parte non in comune tra le due sarà gestito in maniera appropriata -->
		<th:block th:with="counter=${(editabile == true) ? (personaWrapper.idOffset-1) : null}">

					<div class="x_content">
						<!-- rimove il tag form se la persona NON è editabile -->
						<div class="form-horizontal form-label-left" th:remove="${!editabile} ? none : tag">
							<form th:remove="${editabile} ? none : tag"
								id="formPersona" class="form-horizontal form-label-left"
								th:action="@{|/accreditamento/${personaWrapper.accreditamentoId}/provider/${personaWrapper.providerId}/persona/save|}"
								method="post" enctype="multipart/form-data"
								novalidate="novalidate">

						<!-- gli input hidden non sono necessari se NON editabile -->
						<th:block th:if="${editabile}">
							<input type="hidden" name="editId" th:value="${personaWrapper.persona.id}" />
							<input type="hidden" name="editId_Anagrafica" th:value="${personaWrapper.persona.anagrafica.id}" />
							<input type="hidden" th:field="${personaWrapper.accreditamentoId}" />
							<input type="hidden" th:field="${personaWrapper.providerId}" />
							<input type="hidden" th:field="${personaWrapper.ruolo}" />
							<input type="hidden" th:field="${personaWrapper.idEditabili}" />
							<input type="hidden" th:field="${personaWrapper.idOffset}" />
							<input id="hidden-lookup" type="hidden" th:field="${personaWrapper.isLookup}" />
						</th:block>

						<!-- CHECKBOX FLAG COORDINATORE -->
						<div th:if="${personaWrapper.persona.coordinatoreComitatoScientifico} or
									${personaWrapper.persona.componenteComitatoScientifico}"
							class="item form-group" th:classappend="${#fields.hasErrors('personaWrapper.persona.coordinatoreComitatoScientifico')} ? 'bad'">
							<label class="control-label col-md-4 col-sm-4 col-xs-12"
								for="isCoordinatore_comitato"><span th:text="#{label.is_coordinatore}">Inserisci come Coordinatore del Comitato Scientifico</span></label>
							<div class="col-md-4 col-sm-4 col-xs-12">
								<div class="checkbox">
									<input id="isCoordinatore_comitato" name="isCoordinatore_comitato"
										class="flat" type="checkbox" th:field="${personaWrapper.persona.coordinatoreComitatoScientifico}" th:disabled="${!editabile}" />
								</div>
							</div>
							<div th:if="${#fields.hasErrors('personaWrapper.persona.coordinatoreComitatoScientifico')}" class="alert" th:errors="${personaWrapper.persona.coordinatoreComitatoScientifico}"></div>
						</div>

						<!-- COGNOME -->
						<div class="item form-group" th:classappend="${#fields.hasErrors('personaWrapper.persona.anagrafica.cognome')} ? 'bad'">
							<label class="control-label col-xs-1" th:text="${counter != null ? ++counter : ''}">1</label>
							<label class="control-label col-md-3 col-sm-3 col-xs-11"
								for="cognome_persona"><span th:text="#{label.cognome}">Cognome</span> <span	class="required">*</span></label>
							<th:block th:if="${editabile and #lists.contains(personaWrapper.idEditabili, counter)}">
								<div class="col-md-4 col-sm-4 col-xs-12">
									<input id="cognome_persona"	name="cognome_persona"
										required="required"	class="form-control col-md-7 col-xs-12"
										type="text" th:field="${personaWrapper.persona.anagrafica.cognome}" />
								</div>
							</th:block>
							<th:block th:if="${!editabile or !#lists.contains(personaWrapper.idEditabili, counter)}">
								<div class="col-md-4 col-sm-4 col-xs-12">
									<label id="cognome_persona_disabled"
										class="form-control form-disabled-text left-align col-md-7 col-xs-12"
										th:text="${personaWrapper.persona.anagrafica.cognome}"></label>
								</div>
							</th:block>
							<div th:if="${#fields.hasErrors('personaWrapper.persona.anagrafica.cognome')}" class="alert" th:errors="${personaWrapper.persona.anagrafica.cognome}"></div>
						</div>

						<!-- nome -->
						<div class="item form-group" th:classappend="${#fields.hasErrors('personaWrapper.persona.anagrafica.nome')} ? 'bad'">
							<label class="control-label col-xs-1" th:text="${counter != null ? ++counter : ''}">2</label>
							<label class="control-label col-md-3 col-sm-3 col-xs-11"
								for="cognome_persona"><span th:text="#{label.nome}">Nome</span> <span class="required">*</span></label>
							<th:block th:if="${editabile and #lists.contains(personaWrapper.idEditabili, counter)}">
								<div class="col-md-4 col-sm-4 col-xs-12">
									<input id="nome_persona" name="nome_persona"
										required="required"	class="form-control col-md-7 col-xs-12"
										type="text" th:field="${personaWrapper.persona.anagrafica.nome}" />
								</div>
							</th:block>
							<th:block th:if="${!editabile or !#lists.contains(personaWrapper.idEditabili, counter)}">
								<div class="col-md-4 col-sm-4 col-xs-12">
									<label id="nome_persona_disabled" class="form-control form-disabled-text left-align col-md-7 col-xs-12"
										 th:text="${personaWrapper.persona.anagrafica.nome}"></label>
								</div>
							</th:block>
							<div th:if="${#fields.hasErrors('personaWrapper.persona.anagrafica.nome')}" class="alert" th:errors="${personaWrapper.persona.anagrafica.nome}"></div>
						</div>

						<!-- codice fiscale -->
						<div class="item form-group" th:classappend="${#fields.hasErrors('personaWrapper.persona.anagrafica.codiceFiscale')} ? 'bad'">
							<label class="control-label col-xs-1" th:text="${counter != null ? ++counter : ''}">3</label>
							<label class="control-label col-md-3 col-sm-3 col-xs-11"
								for="codiceFiscale_persona"><span th:text="#{label.codice_fiscale}">Codice Fiscale</span> <span class="required">*</span></label>
							<th:block th:if="${editabile and #lists.contains(personaWrapper.idEditabili, counter)}">
								<div class="col-md-4 col-sm-4 col-xs-12">
									<input id="codiceFiscale_persona" name="codiceFiscale_persona"
										required="required"	class="form-control col-md-7 col-xs-12"
										type="text" th:field="${personaWrapper.persona.anagrafica.codiceFiscale}" th:disabled="${personaWrapper.isLookup}" />
								</div>
							</th:block>
							<th:block th:if="${!editabile or !#lists.contains(personaWrapper.idEditabili, counter)}">
								<div class="col-md-4 col-sm-4 col-xs-12">
									<label id="codiceFiscale_persona_disabled" class="form-control form-disabled-text left-align col-md-7 col-xs-12"
										th:text="${personaWrapper.persona.anagrafica.codiceFiscale}"></label>
								</div>
							</th:block>
							<div th:if="${#fields.hasErrors('personaWrapper.persona.anagrafica.codiceFiscale')}" class="alert" th:errors="${personaWrapper.persona.anagrafica.codiceFiscale}"></div>
						</div>

						<!-- checkbox flag straniero -->
						<div th:if="${personaWrapper.persona.coordinatoreComitatoScientifico} or
									${personaWrapper.persona.componenteComitatoScientifico}"
							class="item form-group">
							<label class="control-label col-md-4 col-sm-4 col-xs-12"
								for="isStraniero_persona"><span th:text="#{label.cf_straniero}">Ha un codice fiscale non italiano</span></label>
							<th:block th:if="${editabile and #lists.contains(personaWrapper.idEditabili, counter)}">
								<div class="col-md-4 col-sm-4 col-xs-12">
									<div class="checkbox">
										<input id="isStraniero_persona" name="isStraniero_persona"
											class="flat" type="checkbox" th:field="${personaWrapper.persona.anagrafica.straniero}" />
									</div>
								</div>
							</th:block>
							<th:block th:if="${!editabile or !#lists.contains(personaWrapper.idEditabili, counter)}">
								<div class="col-md-4 col-sm-4 col-xs-12">
									<div class="checkbox">
										<input id="isStraniero_persona" name="isStraniero_persona" disabled="disabled"
											class="flat" type="checkbox" th:field="${personaWrapper.persona.anagrafica.straniero}" />
									</div>
								</div>
							</th:block>
						</div>

						<!-- telefono -->
						<div class="item form-group" th:classappend="${#fields.hasErrors('personaWrapper.persona.anagrafica.telefono')} ? 'bad'">
							<label class="control-label col-xs-1" th:text="${counter != null ? ++counter : ''}">4</label>
							<label class="control-label col-md-3 col-sm-3 col-xs-11"
								for="telefono_persona"><span th:text="#{label.telefono}">Telefono</span> <span class="required">*</span></label>
							<th:block th:if="${editabile and #lists.contains(personaWrapper.idEditabili, counter)}">
								<div class="col-md-4 col-sm-4 col-xs-12">
									<input id="telefono_persona" name="telefono_persona"
										required="required"	class="form-control col-md-7 col-xs-12"
										type="tel" th:field="${personaWrapper.persona.anagrafica.telefono}" />
								</div>
							</th:block>
							<th:block th:if="${!editabile or !#lists.contains(personaWrapper.idEditabili, counter)}">
								<div class="col-md-4 col-sm-4 col-xs-12">
									<label id="telefono_persona_disabled" class="form-control form-disabled-text left-align col-md-7 col-xs-12"
										th:text="${personaWrapper.persona.anagrafica.telefono}"></label>
								</div>
							</th:block>
							<div th:if="${#fields.hasErrors('personaWrapper.persona.anagrafica.telefono')}" class="alert" th:errors="${personaWrapper.persona.anagrafica.telefono}"></div>
						</div>

						<!-- cellulare -->
						<div th:unless="${personaWrapper.persona.responsabileSegreteria} or
										${personaWrapper.persona.responsabileFormazione} or
										${personaWrapper.persona.responsabileSistemaInformatico} or
										${personaWrapper.persona.responsabileQualita}"
							class="item form-group" th:classappend="${#fields.hasErrors('personaWrapper.persona.anagrafica.cellulare')} ? 'bad'">
							<label class="control-label col-xs-1" th:text="${counter != null ? ++counter : ''}">5</label>
							<label class="control-label col-md-3 col-sm-3 col-xs-11"
								for="cellulare_persona"><span th:text="#{label.cellulare}">Cellulare</span> <span class="required">*</span></label>
							<th:block th:if="${editabile and #lists.contains(personaWrapper.idEditabili, counter)}">
								<div class="col-md-4 col-sm-4 col-xs-12">
									<input id="cellulare_persona" name="cellulare_persona"
										required="required"	class="form-control col-md-7 col-xs-12"
										type="tel" th:field="${personaWrapper.persona.anagrafica.cellulare}" />
								</div>
							</th:block>
							<th:block th:if="${!editabile or !#lists.contains(personaWrapper.idEditabili, counter)}">
								<div class="col-md-4 col-sm-4 col-xs-12">
									<label id="cellulare_persona_disabled" class="form-control form-disabled-text left-align col-md-7 col-xs-12"
										th:text="${personaWrapper.persona.anagrafica.cellulare}"></label>
								</div>
							</th:block>
							<div th:if="${#fields.hasErrors('personaWrapper.persona.anagrafica.cellulare')}" class="alert" th:errors="${personaWrapper.persona.anagrafica.cellulare}"></div>
						</div>

						<!-- email -->
						<div class="item form-group" th:classappend="${#fields.hasErrors('personaWrapper.persona.anagrafica.email')} ? 'bad'">
							<label class="control-label col-xs-1" th:text="${counter != null ? ++counter : ''}">6</label>
							<label class="control-label col-md-3 col-sm-3 col-xs-11"
								for="email_persona"><span th:text="#{label.email}">Email</span> <span class="required">*</span></label>
							<th:block th:if="${editabile and #lists.contains(personaWrapper.idEditabili, counter)}">
								<div class="col-md-4 col-sm-4 col-xs-12">
									<input id="email_persona" name="email_persona"
										required="required"	class="form-control col-md-7 col-xs-12"
										type="email" th:field="${personaWrapper.persona.anagrafica.email}" />
								</div>
							</th:block>
							<th:block th:if="${!editabile or !#lists.contains(personaWrapper.idEditabili, counter)}">
								<div class="col-md-4 col-sm-4 col-xs-12">
									<label id="email_persona_disabled" class="form-control form-disabled-text left-align col-md-7 col-xs-12"
										th:text="${personaWrapper.persona.anagrafica.email}"></label>
								</div>
							</th:block>
							<div th:if="${#fields.hasErrors('personaWrapper.persona.anagrafica.email')}" class="alert" th:errors="${personaWrapper.persona.anagrafica.email}"></div>
						</div>

						<!-- posta elettronica certificata (PEC) -->
						<div th:if="${personaWrapper.persona.legaleRappresentante} or
									${personaWrapper.persona.delegatoLegaleRappresentante}"
							class="item form-group" th:classappend="${#fields.hasErrors('personaWrapper.persona.anagrafica.pec')} ? 'bad'">
							<label class="control-label col-xs-1" th:text="${counter != null ? ++counter : ''}">7</label>
							<label class="control-label col-md-3 col-sm-3 col-xs-11"
								for="pec_persona"><span th:text="#{label.posta_elettronica_certificata}">Posta elettronica certificata (PEC)</span> <span class="required">*</span></label>
							<th:block th:if="${editabile and #lists.contains(personaWrapper.idEditabili, counter)}">
								<div class="col-md-4 col-sm-4 col-xs-12">
									<input id="pec_persona" name="pec_persona"
										required="required"	class="form-control col-md-7 col-xs-12"
										type="email" th:field="${personaWrapper.persona.anagrafica.pec}" />
								</div>
							</th:block>
							<th:block th:if="${!editabile or !#lists.contains(personaWrapper.idEditabili, counter)}">
								<div class="col-md-4 col-sm-4 col-xs-12">
									<label id="pec_persona_disabled" class="form-control form-disabled-text left-align col-md-7 col-xs-12"
										th:text="${personaWrapper.persona.anagrafica.pec}"></label>
								</div>
							</th:block>
							<div th:if="${#fields.hasErrors('personaWrapper.persona.anagrafica.pec')}" class="alert" th:errors="${personaWrapper.persona.anagrafica.pec}"></div>
						</div>

						<!-- professione -->
						<div th:if="${personaWrapper.persona.coordinatoreComitatoScientifico} or
									${personaWrapper.persona.componenteComitatoScientifico} or
									${personaWrapper.persona.responsabileSistemaInformatico} or
									${personaWrapper.persona.responsabileQualita}"
							class="item form-group" th:classappend="${#fields.hasErrors('personaWrapper.persona.professione')} ? 'bad'">
							<label class="control-label col-xs-1" th:text="${counter != null ? ++counter : ''}">8</label>
							<label class="control-label col-md-3 col-sm-3 col-xs-11"
								for="professione_persona"><span th:text="#{label.professione}">Professione</span><span class="required">*</span></label>
							<th:block th:if="${editabile and #lists.contains(personaWrapper.idEditabili, counter)}">
								<div class="col-md-4 col-sm-4 col-xs-12">
									<select id="professione_persona" class="form-control required" th:field="${personaWrapper.persona.professione}">
		                          			<option value="" th:text="#{label.seleziona}">label.seleziona</option>
		                          			<option th:each="professione : ${professioneList}" th:value="${professione.id}" th:text="${professione.nome}">Choose option</option>
		                        	</select>
							  	</div>
							</th:block>
							<th:block th:if="${!editabile or !#lists.contains(personaWrapper.idEditabili, counter)}">
								<div class="col-md-4 col-sm-4 col-xs-12">
									<label id="professione_persona_disabled" class="form-control form-disabled-text left-align col-md-7 col-xs-12"
										th:text="${personaWrapper.persona.professione.nome}"></label>
								</div>
							</th:block>
							<div th:if="${#fields.hasErrors('personaWrapper.persona.professione')}" class="alert" th:errors="${personaWrapper.persona.professione}"></div>
						</div>

						<!-- allegato 1 (atto di nomina) -->
						<div th:unless="${personaWrapper.persona.delegatoLegaleRappresentante}">
							<div class="divider-dashed"></div>
							<th:block th:include="fragments/allegati :: allegati(personaWrapper, true, attoNomina, ${counter != null ? ++counter : null}, null, true, ${editabile})" ></th:block>
						</div>

						<!-- allegato 2 (curriculum vitae) -->
						<div th:unless="${personaWrapper.persona.legaleRappresentante}">
							<div class="divider-dashed"></div>
							<th:block th:include="fragments/allegati :: allegati(personaWrapper, true, cv, ${counter != null ? ++counter : null}, null, true, ${editabile})"></th:block>
						</div>

						<!-- allegato 3 (delega) -->
						<div th:if="${personaWrapper.persona.delegatoLegaleRappresentante}">
							<div class="divider-dashed"></div>
							<th:block th:include="fragments/allegati :: allegati(personaWrapper, true, delega, ${counter != null ? ++counter : null}, null, true, ${editabile})"></th:block>
						</div>
					</form>
				</div>
			</div>
		</th:block>
	</th:block>
</body>
</html>