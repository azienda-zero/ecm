<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4"
	layout:decorator="fragments/template">
<head lang="it">
</head>
<body>
	<div layout:fragment="content">
		<div class="row">
			<div class="col-xs-12">
				<div class="x_panel">
					<div class="x_title">
						<h2 th:text="#{label.accreditamento_titolo(Visualizzazione, ${accreditamentoWrapper.accreditamento.tipoDomanda.nome},${accreditamentoWrapper.accreditamento.stato.nome})}">Provvisorio - bozza</h2>
						<div class="pull-right buttons-header">
							<button type="button" class="btn btn-success pull-right" th:text="#{label.modifica}" onclick="switchMode()"></button>
							<a class="btn btn-primary pull-right" th:text="#{label.indietro}" th:href="@{|/provider/${accreditamentoWrapper.provider.id}/accreditamento/list|}"></a>
						</div>
						<div class="clearfix"></div>
					</div>

					<th:block th:include="accreditamento/accreditamentoFragment :: accreditamento(false)"></th:block>

				</div>
			</div>
			<script th:inline="javascript">
			/*<![CDATA[*/

			  	var tabSelected = "tab1";
				$('a[data-toggle="tab"]').on('shown.bs.tab', function (e) {
					tabSelected = e.target.id;
					console.log(tabSelected);
				});

				function switchMode() {
					var param = "?tab=" + tabSelected;
					var url = [[@{|/accreditamento/${accreditamentoWrapper.accreditamento.id}/edit|}]] + param;
					location.href = url;
				}

// 					function switchMode() {
// 						var redirectTab;
// 						var withMessage;

// 						//Check se la tab puÃ² essere aperta in modifica
// 						//In caso negativo apre la prima disponibile e chiede al controller di mandare un messaggio appropriato
// 						switch(tabSelected) {

// 							case "tab1":
// 								redirectTab = "tab1";
// 								withMessage = false;
// 								break;

// 							case "tab2":
// 								if([[${accreditamentoWrapper.sezione1Stato}]]) {
// 									redirectTab = "tab2";
// 									withMessage = false;
// 								}
// 								else {
// 									redirectTab = "tab1";
// 									withMessage = true;
// 								}
// 								break;

// 							case "tab3":
// 								if([[${accreditamentoWrapper.sezione2Stato}]]) {
// 									redirectTab = "tab3";
// 									withMessage = false;
// 								}
// 								else{
// 									if([[${accreditamentoWrapper.sezione1Stato}]]) {
// 										redirectTab = "tab2";
// 										withMessage = true;
// 									}
// 									else {
// 										redirectTab = "tab1";
// 										withMessage = true;
// 									}
// 								}
// 								break;

// 							case "tab4":
// 								if([[${accreditamentoWrapper.completa}]]) {
// 									redirectTab = "tab4";
// 									withMessage = false;
// 								}
// 								if([[${accreditamentoWrapper.sezione2Stato}]]) {
// 									redirectTab = "tab3";
// 									withMessage = true;
// 								}
// 								else{
// 									if([[${accreditamentoWrapper.sezione1Stato}]]) {
// 										redirectTab = "tab2";
// 										withMessage = true;
// 									}
// 									else {
// 										redirectTab = "tab1";
// 										withMessage = true;
// 									}
// 								}
// 								break;

// 						}

// 						var param = "?tab=" + redirectTab;
// 						var msg = "";
// 						if(withMessage)
// 							msg = "&msg=true";
// 						var url = [[@{|/accreditamento/${accreditamentoWrapper.accreditamento.id}/edit|}]] + param + msg;
// 						location.href = url;
// 					}

			/*]]>*/
			</script>
		</div>
	</div>
</body>
</html>